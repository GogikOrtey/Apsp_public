11.12.2025 16:50:01


–ù–∞–π–¥–µ–Ω–æ 19 –≤–æ–∑–º–æ–∂–Ω—ã—Ö —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤
original_selector = html > head > meta[property="og:title"][content]
selector = html > head > meta[property="og:title"][content]
original_selector = html > body.custom_scroll > div.wrapper > main.page-card.bx-catalog-element.bx-blue > section.page-card__mainblock.mainblock.f-screen > div.mainblock__container > div.mainblock__inner > div.mainblock__body.body-mainblock > h1.body-mainblock__title
selector = html > body.custom_scroll > div.wrapper > main.page-card.bx-catalog-element.bx-blue > section.page-card__mainblock.mainblock.f-screen > div.mainblock__container > div.mainblock__inner > div.mainblock__body.body-mainblock > h1.body-mainblock__title
original_selector = html > body.custom_scroll > div.wrapper > main.page-card.bx-catalog-element.bx-blue > section.page-card__mainblock.mainblock.f-screen > div.mainblock__container > div.mainblock__inner > div.mainblock__body.body-mainblock > div.body-mainblock__info > div.body-mainblock__btn > a.btn.js_delivery[data-product-name]
selector = html > body.custom_scroll > div.wrapper > main.page-card.bx-catalog-element.bx-blue > section.page-card__mainblock.mainblock.f-screen > div.mainblock__container > div.mainblock__inner > div.mainblock__body.body-mainblock > div.body-mainblock__info > div.body-mainblock__btn > a.btn.js_delivery[data-product-name]
original_selector = html > body.custom_scroll > div.wrapper > main.page-card.bx-catalog-element.bx-blue > section.page-card__mainblock.mainblock.f-screen > div.mainblock__container > div.mainblock__inner > div.mainblock__slider.slider-mainblock > div.slider-mainblock__slider.swiper > div.slider-mainblock__wrapper.swiper-wrapper > a.slider-mainblock__slide.swiper-slide.slider-mainblock__img > img[alt]
selector = html > body.custom_scroll > div.wrapper > main.page-card.bx-catalog-element.bx-blue > section.page-card__mainblock.mainblock.f-screen > div.mainblock__container > div.mainblock__inner > div.mainblock__slider.slider-mainblock > div.slider-mainblock__slider.swiper > div.slider-mainblock__wrapper.swiper-wrapper > a.slider-mainblock__slide.swiper-slide.slider-mainblock__img > img[alt]
original_selector = html > body.custom_scroll > div.wrapper > main.page-card.bx-catalog-element.bx-blue > div.page-card__fixing-menu.fixing-menu > div.fixing-menu__container > div.fixing-menu__inner > div.fixing-menu__title
selector = html > body.custom_scroll > div.wrapper > main.page-card.bx-catalog-element.bx-blue > div.page-card__fixing-menu.fixing-menu > div.fixing-menu__container > div.fixing-menu__inner > div.fixing-menu__title
original_selector = html > body.custom_scroll > div.wrapper > main.page-card.bx-catalog-element.bx-blue > div.page-card__fixing-menu.fixing-menu > div.fixing-menu__container > div.fixing-menu__inner > div.fixing-menu__btn > a.btn.btn_gradient.js_delivery[data-product-name]
selector = html > body.custom_scroll > div.wrapper > main.page-card.bx-catalog-element.bx-blue > div.page-card__fixing-menu.fixing-menu > div.fixing-menu__container > div.fixing-menu__inner > div.fixing-menu__btn > a.btn.btn_gradient.js_delivery[data-product-name]
original_selector = #parentHorizontalTab > ul.tabs__navigation.resp-tabs-list.hor_1 > a.information__download.download[download="ITALTHERM –∫–æ—Ç–µ–ª –≥–∞–∑–æ–≤—ã–π CITY CLASS 16 F"]
selector = #parentHorizontalTab > ul.tabs__navigation.resp-tabs-list.hor_1 > a.information__download.download[download="ITALTHERM –∫–æ—Ç–µ–ª –≥–∞–∑–æ–≤—ã–π CITY CLASS 16 F"]
original_selector = #parentHorizontalTab > div.tabs__content.resp-tabs-container.hor_1.html_content > div.tabs__body > div.characteristics > div.characteristics__inner > div.characteristics__img.tab-img > div.tab-img__img-item > img[alt]
selector = #parentHorizontalTab > div.tabs__content.resp-tabs-container.hor_1.html_content > div.tabs__body > div.characteristics > div.characteristics__inner > div.characteristics__img.tab-img > div.tab-img__img-item > img[alt]
original_selector = #parentHorizontalTab > div.tabs__content.resp-tabs-container.hor_1.html_content > div.tabs__body > div.description > div.description__inner > div.characteristics__img.tab-img > div.tab-img__img-item > img[alt]
selector = #parentHorizontalTab > div.tabs__content.resp-tabs-container.hor_1.html_content > div.tabs__body > div.description > div.description__inner > div.characteristics__img.tab-img > div.tab-img__img-item > img[alt]
original_selector = html > body.custom_scroll > div.wrapper > main.page-card.bx-catalog-element.bx-blue > section.page-card__compare.compare-block > div.compare-block__container > div.compare-block__table > table tr:has(td:contains("–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ")) > td:nth-child(2)
selector = html > body.custom_scroll > div.wrapper > main.page-card.bx-catalog-element.bx-blue > section.page-card__compare.compare-block > div.compare-block__container > div.compare-block__table > table tr:has(td:contains("–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ")) > td:nth-child(2)
original_selector = #parentHorizontalTab > div.tabs__content.resp-tabs-container.hor_1.html_content > div.tabs__body > div.description > div.description__inner > div.characteristics__img.tab-img > div.tab-img__img-item > img[alt]
selector = #parentHorizontalTab > div.tabs__content.resp-tabs-container.hor_1.html_content > div.tabs__body > div.description > div.description__inner > div.characteristics__img.tab-img > div.tab-img__img-item > img[alt]
original_selector = div.tabs__content.resp-tabs-container.hor_1.html_content > div.tabs__body > div.description > div.description__inner > div.characteristics__img.tab-img > div.tab-img__img-item > img[alt]
selector = div.tabs__content.resp-tabs-container.hor_1.html_content > div.tabs__body > div.description > div.description__inner > div.characteristics__img.tab-img > div.tab-img__img-item > img[alt]
original_selector = div.tabs__body > div.description > div.description__inner > div.characteristics__img.tab-img > div.tab-img__img-item > img[alt]
selector = div.tabs__body > div.description > div.description__inner > div.characteristics__img.tab-img > div.tab-img__img-item > img[alt]
original_selector = div.description > div.description__inner > div.characteristics__img.tab-img > div.tab-img__img-item > img[alt]
selector = div.description > div.description__inner > div.characteristics__img.tab-img > div.tab-img__img-item > img[alt]
original_selector = div.description__inner > div.characteristics__img.tab-img > div.tab-img__img-item > img[alt]
selector = div.description__inner > div.characteristics__img.tab-img > div.tab-img__img-item > img[alt]

üü© selector_result = div.description__inner > div.characteristics__img.tab-img > div.tab-img__img-item > img[alt]



--------------------------------------------------------------------------------------------------

                                        GLOBAL CODE GEN

--------------------------------------------------------------------------------------------------


field = name, stock, link, price, brand, imageLink, timestamp



--------------------------------------------------------------------------------------------------

                                         PARSE PAGE GEN

--------------------------------------------------------------------------------------------------


üüß timestamp –Ω–µ—Ç –≤ –º–∞—Å—Å–∏–≤–µ, –¥–∞–Ω–Ω—ã–µ –¥–ª—è parsePage –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ–∞–∫—Ç—É–∞–ª—å–Ω—ã–º–∏
–ü–æ—Å—ã–ª–∞—é –∑–∞–ø—Ä–æ—Å –∫ YandexGPT:

üí´ PROMPT:
–¢–µ–±–µ –Ω—É–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç URL –∞–¥—Ä–µ—Å –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ –ø–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–∞. –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–∞–∫–æ–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å:

let url = new URL(`${HOST}/search`)
url.searchParams.set("q", set.query)
url.searchParams.set("page", set.page)

–¢–≤–æ—è –∑–∞–¥–∞—á–∞: –í—ã—à–µ –≤ –∫–æ–¥–µ –∑–∞–¥–∞–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ set.query - —ç—Ç–æ —Ç–µ–∫—Å—Ç –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ –ø–æ–∏—Å–∫, –∏ set.page - —ç—Ç–æ —Ç–µ–∫—É—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–∏—Å–∫–∞, –æ–Ω–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å 1. –¢–µ–±–µ –Ω—É–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å –∏ –≤–µ—Ä–Ω—É—Ç—å —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞ –Ω–∞ JS, –≤ –∫–æ—Ç–æ—Ä–æ–º –±—É–¥–µ—Ç —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å—Å—è URL —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —ç—Ç–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤. –ß–∞—â–µ –≤—Å–µ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞ –∏ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∑–∞–¥–∞—é—Ç—Å—è –≤ searchParams, –Ω–æ –∏–Ω–æ–≥–¥–∞ –æ–Ω–∏ –∑–∞–¥–∞—é—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é –≤ —Å—Ç—Ä–æ–∫–µ URL, –≤ —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å —Å `${}`. –¢–∞–∫–∂–µ, –≤ –∏—Å—Ö–æ–¥–Ω–æ–º URL –º–æ–≥—É—Ç –±—ã—Ç—å –∑–∞–¥–∞–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ –∑–∞–ø—Ä–æ—Å –∏ —Ç–µ–∫—É—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É, –≤—Å–µ —ç—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å.

–ü—Ä–∏–º–µ—Ä 1:
–°—Ç—Ä–æ–∫–∞ –Ω–∞ –ø–æ–∏—Å–∫ —É —Å–∞–π—Ç–∞, –Ω–∞ 2—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø–æ–∏—Å–∫–∞: 
https://galen.bg/catalogsearch/result/index/?p=2&q=–º–ª

–§—Ä–∞–≥–º–µ–Ω—Ç —Å —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ–º URL:
let url = new URL(`${HOST}/catalogsearch/result/index/`)
url.searchParams.set("q", set.query)
url.searchParams.set("p", set.page)

–ü—Ä–∏–º–µ—Ä 2:
–°—Ç—Ä–æ–∫–∞ –Ω–∞ –ø–æ–∏—Å–∫ —É —Å–∞–π—Ç–∞, –Ω–∞ 2—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø–æ–∏—Å–∫–∞: 
https://stroytorg812.ru/content/search/?s=&q=–í–∞–Ω–Ω–∞&PAGEN_1=2

–§—Ä–∞–≥–º–µ–Ω—Ç —Å —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ–º URL:
let url = new URL(`${HOST}/content/search/`)
url.searchParams.set("s", "")
url.searchParams.set("q", set.query)
url.searchParams.set("PAGEN_1", set.page)


–ü—Ä–∏–º–µ—Ä 3:
–°—Ç—Ä–æ–∫–∞ –Ω–∞ –ø–æ–∏—Å–∫ —É —Å–∞–π—Ç–∞, –Ω–∞ 2—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø–æ–∏—Å–∫–∞: 
https://gidro-top.ru/search/–í–∞–Ω–Ω–∞/?page=2

–§—Ä–∞–≥–º–µ–Ω—Ç —Å —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ–º URL:
let url = new URL(`${HOST}/search/${set.query}/`)
url.searchParams.set('/?page', set.page);

-----

–¢–µ–∫—É—â–µ–µ –∑–∞–¥–∞–Ω–∏–µ:
–°—Ç—Ä–æ–∫–∞ –Ω–∞ –ø–æ–∏—Å–∫ —É —Å–∞–π—Ç–∞, –Ω–∞ 2—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø–æ–∏—Å–∫–∞: https://gazovik-omsk.ru/catalog/?q=%D0%BA%D0%BE%D1%82%D1%91%D0%BB&PAGEN_2=2

–ó–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π HOST = https://gazovik-omsk.ru

–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ: –ù–∏–∫–∞–∫–∏—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤, –ø–æ—è—Å–Ω–µ–Ω–∏–π, –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –∏ —Ç–µ–∫—Å—Ç–∞ –≤–æ–∫—Ä—É–≥ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –≤—ã–¥–∞–π —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞ - –§—Ä–∞–≥–º–µ–Ω—Ç —Å —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ–º URL.


üí¨ AI ANSWER:
"```
let url = new URL(`${HOST}/catalog/?`)
url.searchParams.set("q", set.query)
url.searchParams.set("PAGEN_2", set.page)
```"

processed_url_product = /catalog/heating-boilers/nastennye-gazovye/italtherm/italtherm-kotel-gazovyy-city-class-25-f/

–ù–∞–π–¥–µ–Ω–æ 1 –≤–æ–∑–º–æ–∂–Ω—ã—Ö —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤
original_selector = html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog.--search > div.catalog__container > div.catalog__inner > div.catalog__content.--search > div.catalog__products.catalog-products > div.horizontal-card > a.horizontal-card__link[href]
selector = html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog > div.catalog__container > div.catalog__inner > div.catalog__content > div.catalog__products.catalog-products > div.horizontal-card > a.horizontal-card__link[href]
original_selector = html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog.--search > div.catalog__container > div.catalog__inner > div.catalog__content.--search > div.catalog__products.catalog-products > div.horizontal-card > a.horizontal-card__link[href]
selector = html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog > div.catalog__container > div.catalog__inner > div.catalog__content > div.catalog__products.catalog-products > div.horizontal-card > a.horizontal-card__link[href]

product_selector = html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog > div.catalog__container > div.catalog__inner > div.catalog__content > div.catalog__products.catalog-products > div.horizontal-card > a.horizontal-card__link[href]
len_of_products_on_this_page = 18
–°–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Å—Å—ã–ª–æ–∫ = 1.00 (3/3)
–ò–∑–≤–ª–µ–∫–∞–µ–º —Å–µ–ª–µ–∫—Ç–æ—Ä –∫–æ–ª-–≤–∞ —Å—Ç—Ä–∞–Ω–∏—Ü

–ù–∞–π–¥–µ–Ω–æ 34 –≤–æ–∑–º–æ–∂–Ω—ã—Ö —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤
original_selector = html
selector = html
original_selector = html > body.custom_scroll
selector = html > body.custom_scroll
original_selector = html > body.custom_scroll > div.wrapper
selector = html > body.custom_scroll > div.wrapper
original_selector = html > body.custom_scroll > div.wrapper > style:nth-of-type(2)
selector = html > body.custom_scroll > div.wrapper > style:nth-of-type(2)
original_selector = html > body.custom_scroll > div.wrapper > main.page-catalog
selector = html > body.custom_scroll > div.wrapper > main.page-catalog
original_selector = html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog.--search
selector = html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog
original_selector = html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog.--search > div.catalog__container
selector = html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog > div.catalog__container
original_selector = html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog.--search > div.catalog__container > div.catalog__inner
selector = html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog > div.catalog__container > div.catalog__inner
original_selector = html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog.--search > div.catalog__container > div.catalog__inner > div.catalog__content.--search
selector = html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog > div.catalog__container > div.catalog__inner > div.catalog__content
original_selector = html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog.--search > div.catalog__container > div.catalog__inner > div.catalog__content.--search > div.catalog__products.catalog-products
selector = html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog > div.catalog__container > div.catalog__inner > div.catalog__content > div.catalog__products.catalog-products
original_selector = html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog.--search > div.catalog__container > div.catalog__inner > div.catalog__content.--search > div.catalog__products.catalog-products > div.horizontal-card
selector = html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog > div.catalog__container > div.catalog__inner > div.catalog__content > div.catalog__products.catalog-products > div.horizontal-card
original_selector = html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog.--search > div.catalog__container > div.catalog__inner > div.catalog__content.--search > div.catalog__products.catalog-products > div.horizontal-card > div.horizontal-card__info
selector = html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog > div.catalog__container > div.catalog__inner > div.catalog__content > div.catalog__products.catalog-products > div.horizontal-card > div.horizontal-card__info
original_selector = html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog.--search > div.catalog__container > div.catalog__inner > div.catalog__content.--search > div.catalog__products.catalog-products > div.horizontal-card > div.horizontal-card__info > div.horizontal-card__prices
selector = html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog > div.catalog__container > div.catalog__inner > div.catalog__content > div.catalog__products.catalog-products > div.horizontal-card > div.horizontal-card__info > div.horizontal-card__prices
original_selector = html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog.--search > div.catalog__container > div.catalog__inner > div.catalog__content.--search > div.catalog__products.catalog-products > div.horizontal-card > div.horizontal-card__info > div.horizontal-card__prices > div.horizontal-card__price
selector = html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog > div.catalog__container > div.catalog__inner > div.catalog__content > div.catalog__products.catalog-products > div.horizontal-card > div.horizontal-card__info > div.horizontal-card__prices > div.horizontal-card__price
original_selector = html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog.--search > div.catalog__container > div.catalog__inner > div.catalog__content.--search > div.catalog__products.catalog-products > div.horizontal-card > div.horizontal-card__tags
selector = html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog > div.catalog__container > div.catalog__inner > div.catalog__content > div.catalog__products.catalog-products > div.horizontal-card > div.horizontal-card__tags
original_selector = html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog.--search > div.catalog__container > div.catalog__inner > div.catalog__content.--search > div.catalog__products.catalog-products > div.horizontal-card > div.horizontal-card__tags > div.horizontal-card__tag
selector = html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog > div.catalog__container > div.catalog__inner > div.catalog__content > div.catalog__products.catalog-products > div.horizontal-card > div.horizontal-card__tags > div.horizontal-card__tag
original_selector = html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog.--search > div.catalog__container > div.catalog__inner > div.catalog__content.--search > div.catalog__products.catalog-products > div.horizontal-card > div.horizontal-card__img > div.horizontal-card__img-item > img[src]
selector = html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog > div.catalog__container > div.catalog__inner > div.catalog__content > div.catalog__products.catalog-products > div.horizontal-card > div.horizontal-card__img > div.horizontal-card__img-item > img[src]
original_selector = html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog.--search > div.catalog__container > div.catalog__inner > div.catalog__content.--search > div.catalog__pagging.pagging
selector = html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog > div.catalog__container > div.catalog__inner > div.catalog__content > div.catalog__pagging.pagging
original_selector = html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog.--search > div.catalog__container > div.catalog__inner > div.catalog__content.--search > div.catalog__pagging.pagging > ul.pagging__list
selector = html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog > div.catalog__container > div.catalog__inner > div.catalog__content > div.catalog__pagging.pagging > ul.pagging__list
original_selector = html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog.--search > div.catalog__container > div.catalog__inner > div.catalog__content.--search > div.catalog__pagging.pagging > ul.pagging__list > li.pagging__item
selector = html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog > div.catalog__container > div.catalog__inner > div.catalog__content > div.catalog__pagging.pagging > ul.pagging__list > li.pagging__item
original_selector = html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog.--search > div.catalog__container > div.catalog__inner > div.catalog__content.--search > div.catalog__pagging.pagging > ul.pagging__list > li.pagging__item > a.pagging__link
selector = html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog > div.catalog__container > div.catalog__inner > div.catalog__content > div.catalog__pagging.pagging > ul.pagging__list > li.pagging__item > a.pagging__link
original_selector = html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog.--search > div.catalog__container > div.catalog__inner > div.catalog__content.--search > div.catalog__pagging.pagging > ul.pagging__list > li.pagging__item > a.pagging__link[href]
selector = html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog > div.catalog__container > div.catalog__inner > div.catalog__content > div.catalog__pagging.pagging > ul.pagging__list > li.pagging__item > a.pagging__link[href]
original_selector = html > body.custom_scroll > div.wrapper > footer.footer > div.footer__container > div.footer__top > div.top-footer > div.top-footer__inner > div.top-footer__left > a.top-footer__logo.logo > svg > path[d="M20.5465 15.6788C20.5543 9.12495 18.1059 5.75052 15.0166 0.962891C16.4503 5.25019 16.0759 9.0643 12.6673 12.5211C8.4352 16.8125 1.6635 22.0601 0.39433 28.9885C-2.04043 42.2825 7.22316 48.6768 16.5338 56.9567C14.1149 51.2631 9.99719 47.1427 10.9213 39.9689C11.9572 31.9283 20.5356 24.9878 20.5465 15.6788Z"]
selector = html > body.custom_scroll > div.wrapper > footer.footer > div.footer__container > div.footer__top > div.top-footer > div.top-footer__inner > div.top-footer__left > a.top-footer__logo.logo > svg > path[d="M20.5465 15.6788C20.5543 9.12495 18.1059 5.75052 15.0166 0.962891C16.4503 5.25019 16.0759 9.0643 12.6673 12.5211C8.4352 16.8125 1.6635 22.0601 0.39433 28.9885C-2.04043 42.2825 7.22316 48.6768 16.5338 56.9567C14.1149 51.2631 9.99719 47.1427 10.9213 39.9689C11.9572 31.9283 20.5356 24.9878 20.5465 15.6788Z"]
original_selector = html > body.custom_scroll > div.wrapper > footer.footer > div.footer__container > div.footer__top > div.top-footer > div.top-footer__inner > div.top-footer__left > a.top-footer__logo.logo > svg > path[d="M19.5308 37.9296C18.3405 33.478 13.1333 24.9606 15.6119 17.7268C15.8278 18.0565 15.978 22.2243 18.2321 25.7503C21.4722 30.8188 25.8804 32.5722 27.5821 36.6642C30.7625 44.3122 17.2747 49.8014 21.1488 64.7944C19.5646 61.7385 18.7019 60.5494 18.0428 55.5196C17.3167 49.981 21.431 45.0356 19.5308 37.9296Z"]
selector = html > body.custom_scroll > div.wrapper > footer.footer > div.footer__container > div.footer__top > div.top-footer > div.top-footer__inner > div.top-footer__left > a.top-footer__logo.logo > svg > path[d="M19.5308 37.9296C18.3405 33.478 13.1333 24.9606 15.6119 17.7268C15.8278 18.0565 15.978 22.2243 18.2321 25.7503C21.4722 30.8188 25.8804 32.5722 27.5821 36.6642C30.7625 44.3122 17.2747 49.8014 21.1488 64.7944C19.5646 61.7385 18.7019 60.5494 18.0428 55.5196C17.3167 49.981 21.431 45.0356 19.5308 37.9296Z"]
original_selector = html > body.custom_scroll > div.wrapper > footer.footer > div.footer__container > div.footer__top > div.top-footer > div.top-footer__inner > div.top-footer__left > a.top-footer__logo.logo > svg > path[d="M17.5639 50.3703C17.2737 48.8602 16.3717 47.5987 15.6219 46.2551C15.1844 47.8486 14.1138 49.1031 14.2948 50.7232C14.5156 52.6988 16.1378 55.7968 16.4563 56.0747C16.582 56.1843 17.2004 55.9411 17.2296 55.7997C17.2483 55.7095 18.006 52.6696 17.5639 50.3703ZM17.0295 51.9486C16.5809 50.2376 16.157 49.7903 15.8582 49.7324C15.5413 49.8902 15.3217 50.5275 15.4734 52.2973C15.599 53.76 16.3093 55.8002 16.5447 56.0054C16.6373 56.0863 17.0768 55.9943 17.0982 55.8899C17.1118 55.8236 17.47 53.6273 17.0295 51.9486Z"]
selector = html > body.custom_scroll > div.wrapper > footer.footer > div.footer__container > div.footer__top > div.top-footer > div.top-footer__inner > div.top-footer__left > a.top-footer__logo.logo > svg > path[d="M17.5639 50.3703C17.2737 48.8602 16.3717 47.5987 15.6219 46.2551C15.1844 47.8486 14.1138 49.1031 14.2948 50.7232C14.5156 52.6988 16.1378 55.7968 16.4563 56.0747C16.582 56.1843 17.2004 55.9411 17.2296 55.7997C17.2483 55.7095 18.006 52.6696 17.5639 50.3703ZM17.0295 51.9486C16.5809 50.2376 16.157 49.7903 15.8582 49.7324C15.5413 49.8902 15.3217 50.5275 15.4734 52.2973C15.599 53.76 16.3093 55.8002 16.5447 56.0054C16.6373 56.0863 17.0768 55.9943 17.0982 55.8899C17.1118 55.8236 17.47 53.6273 17.0295 51.9486Z"]
original_selector = html > body.custom_scroll > div.wrapper > footer.footer > div.footer__container > div.footer__top > div.top-footer > div.top-footer__inner > div.top-footer__left > a.top-footer__logo.logo > svg > path[d="M46.3015 23.509H37.7163V45.1355H32.8774V19.2922H46.3015V23.509ZM67.6186 45.1355H62.5396L60.2975 39.3076H49.1843L46.9593 45.1355H41.8802L52.1699 19.2922H57.3118L67.6186 45.1355ZM58.7532 35.2908L54.7495 24.8803L50.7285 35.2908H58.7532ZM86.9281 37.6676C86.9281 40.0674 85.973 42.0387 84.0626 43.5757C82.2609 45.0269 80.0874 45.7526 77.5251 45.7526C73.7501 45.7526 70.6615 44.1528 68.2592 40.9474L70.9761 38.0047C72.4804 40.3589 74.5451 41.5359 77.159 41.5359C78.6118 41.5359 79.75 41.1359 80.5793 40.3303C81.3401 39.5818 81.7176 38.6219 81.7176 37.4505C81.7176 36.2335 81.2829 35.2678 80.4078 34.5536C79.5041 33.8166 78.2572 33.4509 76.6728 33.4509H73.956V29.5027H76.6385C77.9884 29.5027 79.0465 29.1942 79.8072 28.5714C80.5737 27.9543 80.9568 27.1201 80.9568 26.0687C80.9568 23.8576 79.6527 22.7548 77.0389 22.7548C74.8025 22.7548 72.978 23.589 71.5594 25.2517L69.4661 22.0006C71.7768 19.6923 74.5108 18.5381 77.6566 18.5381C80.1733 18.5381 82.1923 19.1552 83.7251 20.395C85.2866 21.6807 86.0702 23.4119 86.0702 25.6003C86.0702 26.863 85.7328 27.9886 85.0579 28.9828C84.3829 29.977 83.4735 30.6969 82.3353 31.1426C85.3953 32.1996 86.9281 34.3765 86.9281 37.6676ZM116.979 32.2111C116.979 35.9822 115.635 39.1819 112.941 41.8101C110.247 44.4384 106.964 45.7526 103.086 45.7526C99.214 45.7526 95.9252 44.4384 93.2255 41.8101C90.5316 39.1819 89.1817 35.9822 89.1817 32.2111C89.1817 28.44 90.5316 25.2403 93.2255 22.612C95.9252 19.9836 99.214 18.6695 103.086 18.6695C106.964 18.6695 110.247 19.9836 112.941 22.612C115.635 25.2403 116.979 28.44 116.979 32.2111ZM112.037 32.2111C112.037 29.7028 111.179 27.5887 109.458 25.8688C107.736 24.1489 105.614 23.2919 103.092 23.2919C100.587 23.2919 98.4705 24.1547 96.7488 25.8745C95.0215 27.6 94.1578 29.7141 94.1578 32.2111C94.1578 34.7079 95.0215 36.8164 96.7488 38.5361C98.4705 40.256 100.587 41.113 103.092 41.113C105.614 41.113 107.736 40.256 109.458 38.5361C111.179 36.8164 112.037 34.7079 112.037 32.2111ZM137.261 37.7705C137.261 40.136 136.443 41.9529 134.813 43.2271C133.183 44.5013 130.878 45.1355 127.892 45.1355H120.102V19.2922H126.937C129.631 19.2922 131.696 19.8979 133.126 21.115C134.51 22.3091 135.202 24.0119 135.202 26.223C135.202 27.28 134.899 28.2629 134.298 29.1656C133.726 30.0284 132.966 30.6969 132.016 31.1768C133.578 31.5654 134.853 32.3996 135.837 33.6681C136.786 34.8965 137.261 36.262 137.261 37.7705ZM130.575 26.6573C130.575 24.349 129.059 23.1948 126.033 23.1948H124.941V30.0512H126.348C127.646 30.0512 128.676 29.7599 129.437 29.1714C130.197 28.5885 130.575 27.7486 130.575 26.6573ZM132.422 37.5191C132.422 34.9879 130.661 33.7194 127.137 33.7194H124.941V41.2331H127.137C130.661 41.2331 132.422 39.9931 132.422 37.5191ZM162.462 45.1355H157.623V26.5202L145.332 45.1355H140.493V19.2922H145.332L145.337 37.8048L157.623 19.2922H162.462V45.1355ZM188 45.1355H181.651L171.659 32.5139V45.1355H166.82V19.2922H171.659V30.7369L181.365 19.2922H187.48L176.475 31.4968L188 45.1355Z"]
selector = html > body.custom_scroll > div.wrapper > footer.footer > div.footer__container > div.footer__top > div.top-footer > div.top-footer__inner > div.top-footer__left > a.top-footer__logo.logo > svg > path[d="M46.3015 23.509H37.7163V45.1355H32.8774V19.2922H46.3015V23.509ZM67.6186 45.1355H62.5396L60.2975 39.3076H49.1843L46.9593 45.1355H41.8802L52.1699 19.2922H57.3118L67.6186 45.1355ZM58.7532 35.2908L54.7495 24.8803L50.7285 35.2908H58.7532ZM86.9281 37.6676C86.9281 40.0674 85.973 42.0387 84.0626 43.5757C82.2609 45.0269 80.0874 45.7526 77.5251 45.7526C73.7501 45.7526 70.6615 44.1528 68.2592 40.9474L70.9761 38.0047C72.4804 40.3589 74.5451 41.5359 77.159 41.5359C78.6118 41.5359 79.75 41.1359 80.5793 40.3303C81.3401 39.5818 81.7176 38.6219 81.7176 37.4505C81.7176 36.2335 81.2829 35.2678 80.4078 34.5536C79.5041 33.8166 78.2572 33.4509 76.6728 33.4509H73.956V29.5027H76.6385C77.9884 29.5027 79.0465 29.1942 79.8072 28.5714C80.5737 27.9543 80.9568 27.1201 80.9568 26.0687C80.9568 23.8576 79.6527 22.7548 77.0389 22.7548C74.8025 22.7548 72.978 23.589 71.5594 25.2517L69.4661 22.0006C71.7768 19.6923 74.5108 18.5381 77.6566 18.5381C80.1733 18.5381 82.1923 19.1552 83.7251 20.395C85.2866 21.6807 86.0702 23.4119 86.0702 25.6003C86.0702 26.863 85.7328 27.9886 85.0579 28.9828C84.3829 29.977 83.4735 30.6969 82.3353 31.1426C85.3953 32.1996 86.9281 34.3765 86.9281 37.6676ZM116.979 32.2111C116.979 35.9822 115.635 39.1819 112.941 41.8101C110.247 44.4384 106.964 45.7526 103.086 45.7526C99.214 45.7526 95.9252 44.4384 93.2255 41.8101C90.5316 39.1819 89.1817 35.9822 89.1817 32.2111C89.1817 28.44 90.5316 25.2403 93.2255 22.612C95.9252 19.9836 99.214 18.6695 103.086 18.6695C106.964 18.6695 110.247 19.9836 112.941 22.612C115.635 25.2403 116.979 28.44 116.979 32.2111ZM112.037 32.2111C112.037 29.7028 111.179 27.5887 109.458 25.8688C107.736 24.1489 105.614 23.2919 103.092 23.2919C100.587 23.2919 98.4705 24.1547 96.7488 25.8745C95.0215 27.6 94.1578 29.7141 94.1578 32.2111C94.1578 34.7079 95.0215 36.8164 96.7488 38.5361C98.4705 40.256 100.587 41.113 103.092 41.113C105.614 41.113 107.736 40.256 109.458 38.5361C111.179 36.8164 112.037 34.7079 112.037 32.2111ZM137.261 37.7705C137.261 40.136 136.443 41.9529 134.813 43.2271C133.183 44.5013 130.878 45.1355 127.892 45.1355H120.102V19.2922H126.937C129.631 19.2922 131.696 19.8979 133.126 21.115C134.51 22.3091 135.202 24.0119 135.202 26.223C135.202 27.28 134.899 28.2629 134.298 29.1656C133.726 30.0284 132.966 30.6969 132.016 31.1768C133.578 31.5654 134.853 32.3996 135.837 33.6681C136.786 34.8965 137.261 36.262 137.261 37.7705ZM130.575 26.6573C130.575 24.349 129.059 23.1948 126.033 23.1948H124.941V30.0512H126.348C127.646 30.0512 128.676 29.7599 129.437 29.1714C130.197 28.5885 130.575 27.7486 130.575 26.6573ZM132.422 37.5191C132.422 34.9879 130.661 33.7194 127.137 33.7194H124.941V41.2331H127.137C130.661 41.2331 132.422 39.9931 132.422 37.5191ZM162.462 45.1355H157.623V26.5202L145.332 45.1355H140.493V19.2922H145.332L145.337 37.8048L157.623 19.2922H162.462V45.1355ZM188 45.1355H181.651L171.659 32.5139V45.1355H166.82V19.2922H171.659V30.7369L181.365 19.2922H187.48L176.475 31.4968L188 45.1355Z"]
original_selector = html > body.custom_scroll > div.wrapper > footer.footer > div.footer__container > div.footer__top > div.top-footer > div.top-footer__inner > div.top-footer__middle > div.top-footer__spollers > div.spollers > div.spollers__item > div.spollers__body > div.contacts-footer > div.contacts-footer__items > div.contacts-footer__item.item-contacts > a.item-contacts__link.item-contacts__street > svg > path[d="M17.657 16.6567L13.414 20.8997C13.039 21.2743 12.5306 21.4848 12.0005 21.4848C11.4704 21.4848 10.962 21.2743 10.587 20.8997L6.343 16.6567C5.22422 15.5379 4.46234 14.1124 4.15369 12.5606C3.84504 11.0087 4.00349 9.40022 4.60901 7.93844C5.21452 6.47665 6.2399 5.22725 7.55548 4.34821C8.87107 3.46918 10.4178 3 12 3C13.5822 3 15.1289 3.46918 16.4445 4.34821C17.7601 5.22725 18.7855 6.47665 19.391 7.93844C19.9965 9.40022 20.155 11.0087 19.8463 12.5606C19.5377 14.1124 18.7758 15.5379 17.657 16.6567Z"]
selector = html > body.custom_scroll > div.wrapper > footer.footer > div.footer__container > div.footer__top > div.top-footer > div.top-footer__inner > div.top-footer__middle > div.top-footer__spollers > div.spollers > div.spollers__item > div.spollers__body > div.contacts-footer > div.contacts-footer__items > div.contacts-footer__item.item-contacts > a.item-contacts__link.item-contacts__street > svg > path[d="M17.657 16.6567L13.414 20.8997C13.039 21.2743 12.5306 21.4848 12.0005 21.4848C11.4704 21.4848 10.962 21.2743 10.587 20.8997L6.343 16.6567C5.22422 15.5379 4.46234 14.1124 4.15369 12.5606C3.84504 11.0087 4.00349 9.40022 4.60901 7.93844C5.21452 6.47665 6.2399 5.22725 7.55548 4.34821C8.87107 3.46918 10.4178 3 12 3C13.5822 3 15.1289 3.46918 16.4445 4.34821C17.7601 5.22725 18.7855 6.47665 19.391 7.93844C19.9965 9.40022 20.155 11.0087 19.8463 12.5606C19.5377 14.1124 18.7758 15.5379 17.657 16.6567Z"]
original_selector = html > body.custom_scroll > div.wrapper > footer.footer > div.footer__container > div.top-footer__slider.blocks2slider > div.blocks2slider__items.js_blocks2slider.swiper > div.blocks2slider__wrapper.swiper-wrapper > div.blocks2slider__item.swiper-slide > a.item-company > img[src]
selector = html > body.custom_scroll > div.wrapper > footer.footer > div.footer__container > div.top-footer__slider.blocks2slider > div.blocks2slider__items.js_blocks2slider.swiper > div.blocks2slider__wrapper.swiper-wrapper > div.blocks2slider__item.swiper-slide > a.item-company > img[src]
original_selector = html > body.custom_scroll > style:nth-of-type(1)
selector = html > body.custom_scroll > style:nth-of-type(1)
original_selector = html > body.custom_scroll > script:nth-of-type(14)
selector = html > body.custom_scroll > script:nth-of-type(14)
original_selector = html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog.--search > div.catalog__container > div.catalog__inner > div.catalog__content.--search > div.catalog__pagging.pagging > ul.pagging__list > li.pagging__item > a.pagging__link
selector = html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog > div.catalog__container > div.catalog__inner > div.catalog__content > div.catalog__pagging.pagging > ul.pagging__list > li.pagging__item > a.pagging__link
pagination_selctor = html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog.--search > div.catalog__container > div.catalog__inner > div.catalog__content.--search > div.catalog__pagging.pagging > ul.pagging__list > li.pagging__item > a.pagging__link
original_selector = html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog.--search > div.catalog__container > div.catalog__inner > div.catalog__content.--search > div.catalog__pagging.pagging > ul.pagging__list > li.pagging__item > a.pagging__link
selector = html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog > div.catalog__container > div.catalog__inner > div.catalog__content > div.catalog__pagging.pagging > ul.pagging__list > li.pagging__item > a.pagging__link
–ü—Ä–æ–≤–µ—Ä–∏–ª–∏, –∏ –Ω–∞—à–ª–∏ —Ç–∞–∫–æ–π —ç–ª–µ–º–µ–Ω—Ç –ø–æ –Ω–∞–π–¥–µ–Ω–Ω–æ–º—É —Å–µ–ª–µ–∫—Ç–æ—Ä—É –ø–∞–≥–∏–Ω–∞—Ü–∏–∏: 1
result_pagination_block = 

let totalPages = Math.max(...$("html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog.--search > div.catalog__container > div.catalog__inner > div.catalog__content.--search > div.catalog__pagging.pagging > ul.pagging__list > li.pagging__item > a.pagging__link").get().map(item => +$(item).text().trim()).filter(Boolean))
async parsePage(set: SetType) {
        let url = new URL(`${HOST}/catalog/?`)
		url.searchParams.set("q", set.query)
		url.searchParams.set("PAGEN_2", set.page)

        const data = await this.makeRequest(url.href)
        const $ = cheerio.load(data)

        if (set.page === 1) {
            let totalPages = Math.max(...$("html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog.--search > div.catalog__container > div.catalog__inner > div.catalog__content.--search > div.catalog__pagging.pagging > ul.pagging__list > li.pagging__item > a.pagging__link").get().map(item => +$(item).text().trim()).filter(Boolean)) 
            this.debugger.put(`totalPages = ${totalPages}`)
            for (let page = 2; page <= Math.min(totalPages, +this.conf.pagesCount); page++) {
                this.query.add({ ...set, query: set.query, type: "page", page: page, lvl: 1 });
            }
        }
        
        let products = $("html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog > div.catalog__container > div.catalog__inner > div.catalog__content > div.catalog__products.catalog-products > div.horizontal-card > a.horizontal-card__link[href]") 
        if (products.length == 0) {
            this.logger.put(`–ü–æ –∑–∞–ø—Ä–æ—Å—É ${set.query} –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ`)
            throw new NotFoundError()
        }
        products.slice(0, +this.conf.itemsCount).each((i, product) => {
            let link = `${HOST}${$(product)?.attr("href")}`
            this.query.add({ ...set, query: link, type: "card", lvl: 1 })
        }) 
    }
–ò–º—è –ø–∞—Ä—Å–µ—Ä–∞: JS_Base_gazovikomskru



--------------------------------------------------------------------------------------------------

                                    FINAL RESULT PARSER CODE

--------------------------------------------------------------------------------------------------


import { getDefaultConf, defaultEditableConf, defaultOpts, getCacher } from "../Base-Custom/Constants";
import { AsyncHTTPXRequestOptsCustom, defaultConf, editableConf, Item } from "../Base-Custom/Types";
import { InvalidLinkError, NotFoundError } from "../Base-Custom/Errors";
import { JS_Base_Custom } from "../Base-Custom/Base-Custom";
import { getTimestamp } from "../Base-Custom/Utils";
import { SetType, tools } from "a-parser-types";
import { Cacher } from "../Base-Custom/Cache";
import {
    toArray, isBadLink,
    name, stock, link, price, brand, imageLink, timestamp
} from "../Base-Custom/Fields"
import * as cheerio from "cheerio";

//#region –ö–∞—Å—Ç–æ–º–Ω—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö
type ResultItem = Item<typeof fields>

//#region –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã
const fields = {
    name, stock, link, price, brand, imageLink, timestamp
}

const HOST = "https://gazovik-omsk.ru"

export class JS_Base_gazovikomskru extends JS_Base_Custom {
    static defaultConf: defaultConf = {
            ...getDefaultConf(toArray(fields), "Œ∂", [isBadLink]),
            parsecodes: { 200: 1, 404: 1 },
            proxyChecker: "tor.proxy.ru",
            requestdelay: "3,5",
            engine: "a-parser",
            mode: "normal",
        };

    static editableConf: editableConf = [
        ...defaultEditableConf
    ];

    //#region –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
    async parse(set: SetType, results: { [key: string]: any }) {
        if (!set.type || set.type === "none") set.type = "page";
        if (!set.region || set.region === "none") set.region = "";
        try {
            switch (set.type) {
                case "page": {
                    if (!set.page || set.page === "none") set.page = 1;
                    await this.parsePage(set);
                    results.success = 1;
                    break;
                }
                case "card": {
                    const cacher = getCacher<ResultItem>(this, set)
                    let items = cacher.cache || await this.parseCard(set, cacher);
                    items.forEach(item => results.items.addElement(item));
                    results.success = 1;
                    break;
                }
                default:
                    this.logger.put("–£–∫–∞–∑–∞–Ω –Ω–µ–≤–µ—Ä–Ω—ã–π —Ç–∏–ø —Å–±–æ—Ä–∞")
                    results.success = 0;
            }
        } catch (e: any) {
            if (e instanceof NotFoundError || e instanceof InvalidLinkError) {
                this.logger.put(e.message);
                results.isBadLink = 1;
                results.success = 1;
            } else {
                this.logger.put(`${e.name} >> ${e.message}   ${set.query}  type - ${set.type} page ${set.page} }`);
                results.success = 0;
            }
        }
        return results;
    }

    //#region –ü–∞—Ä—Å–∏–Ω–≥ –ø–æ–∏—Å–∫–∞
    async parsePage(set: SetType) {
        let url = new URL(`${HOST}/catalog/?`)
		url.searchParams.set("q", set.query)
		url.searchParams.set("PAGEN_2", set.page)

        const data = await this.makeRequest(url.href)
        const $ = cheerio.load(data)

        if (set.page === 1) {
            let totalPages = Math.max(...$("html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog.--search > div.catalog__container > div.catalog__inner > div.catalog__content.--search > div.catalog__pagging.pagging > ul.pagging__list > li.pagging__item > a.pagging__link").get().map(item => +$(item).text().trim()).filter(Boolean)) 
            this.debugger.put(`totalPages = ${totalPages}`)
            for (let page = 2; page <= Math.min(totalPages, +this.conf.pagesCount); page++) {
                this.query.add({ ...set, query: set.query, type: "page", page: page, lvl: 1 });
            }
        }
        
        let products = $("html > body.custom_scroll > div.wrapper > main.page-catalog > section.page-catalog__catalog.catalog > div.catalog__container > div.catalog__inner > div.catalog__content > div.catalog__products.catalog-products > div.horizontal-card > a.horizontal-card__link[href]") 
        if (products.length == 0) {
            this.logger.put(`–ü–æ –∑–∞–ø—Ä–æ—Å—É ${set.query} –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ`)
            throw new NotFoundError()
        }
        products.slice(0, +this.conf.itemsCount).each((i, product) => {
            let link = `${HOST}${$(product)?.attr("href")}`
            this.query.add({ ...set, query: link, type: "card", lvl: 1 })
        }) 
    }

    //#region –ü–∞—Ä—Å–∏–Ω–≥ —Ç–æ–≤–∞—Ä–∞
    

    //#region –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞
    async makeRequest(url: string) {
        const opts: AsyncHTTPXRequestOptsCustom = {
            ...defaultOpts,
            engine: this.conf.engine,
            mode: this.conf.mode,
        };
        this.debugger.put(opts)

        const { success, headers, data } = await this.request("GET", url, {}, opts);
        this.debugger.put(data)

        if (!success || typeof data !== "string") throw new Error("–ù–µ—É–¥–∞—á–Ω—ã–π –∑–∞–ø—Ä–æ—Å");
        if (headers.Status === 404) throw new NotFoundError();

        return data;
    }
}

// –ö–æ–¥ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω APSP v0.1
// –î–∞—Ç–∞: 11 –î–µ–∫ 2025
// ¬© BrandPol

–°–æ–æ–±—â–µ–Ω–∏—è –∏–∑ message_global:
üü° [–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ]: timestamp –Ω–µ—Ç –≤ –º–∞—Å—Å–∏–≤–µ, –¥–∞–Ω–Ω—ã–µ –¥–ª—è parsePage –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ–∞–∫—Ç—É–∞–ª—å–Ω—ã–º–∏

–ò—Ç–æ–≥–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏: üü© Sucsess üü©

üïö –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: 1.88 —Å–µ–∫—É–Ω–¥
üß¢ –ö–æ–ª-–≤–æ –æ–±—Ä–∞—â–µ–Ω–∏–π –∫ –≤–Ω–µ—à–Ω–µ–º—É –ò–ò: 1
